# 1.데이터베이스 설계
## 1. 데이터베이스 설계 개념
- 사용자의 요구를 분석하고 컴퓨터에 저장, 구조변형, 특정 DBMS 구현
## 2. 데이터베이스 설계 시 고려사항
- 무결성: 삽입,삭제,갱신 등의 연산후 정해진 제약 조건을 항상 만족
- 일관성: 응답이 처음부터 끝까지 변함없이 일정
- 회복: 장애 발생시 발생 직전으로 복구 가능
- 보안: 불법적인 공격으로 보호 가능
- 효율성: 응답시간 단축, 시스템의 생산성, 저장 공간의 최적화등이 가능
- DB 확장: 운영에 영향을 주지 않으면서 지속적인 테이블 추가 가능
## 3. 설계 순서
- 1. 요구 조건 분석: 요구 조건 명세서 작성
- 2. 개념적 설계: 개념 스키마, 트랜잭션 모델링, E-R 모델링
- 3. 논리적 설계: 논리 스키마 설계, 트랜잭션 인터페이스 설계
- 4. 물리적 설계: 데이터 변환
- 5. 구현: DDL로 데이터베이스 생성
## 4. 요구 조건 분석
- DB 사용하는 사람의 필요 용도 파악
- 종류,용도,처리 형태, 흐름, 제약 조건 수집
- 수집 내용 바탕으로 명세 작성
## 5. 개념적 설계(정보 모델링, 개념화)
- 추상적 개념으로 표현하는 과정
- 스키마 모델링과 트랜잭션 모댈링을 병행
- 요구 분석 단계에서 나온 결과로 독립적인 E-R 다이어그램 작성
- 독립적인 스키마로 설계
## 6. 논리적 설계(데이터 모델링)
- 특정 DBMS를 지원하는 논리적 자료 구조로 변환
- 데이터 타입 간의 관계로 표현된는 논리적 구조의 데이터로 모델링
- 서로 다른 논리적 스키마를 설계하는 단계
- 트랜잭션 인터페이스를 설계
- 관계형 DB라면 테이블 설계
## 7. 물리적 설계(데이터 구조화)
- 각 저장장치에 데이터를 물리적 구조로 데이터를 변환하는 과정
- DB 파일, 저장 구조 및 액세스 경로 결정
- 양식 순서, 접근 경로, 조회가 집중되는 레코드와 같은 정보를 사용하여 컴퓨터에 저장
#### 고려사항
- 트랜잭션 처리량
- 응답시간
- 디스크 용량
- 저장 공간의 효율
## 8. 데이터베이스 구현
- 물리적 설계를 기반으로 데이터베이스 스키마를 파일로 생성하는 과정
- 스키마를 기술한 후 컴파일하여 빈 데이터베이스 파일 생성
- 생성된 빈 데이터베이스 파일에 데이터 입력
- 응용 프로그램을 위한 트랜잭션을 작성
- 데이터베이스 접근을 위한 응용 프로그램 작성
# 2.데이터 모델의 개념
## 1. 데이터 모델의 정의
- 단순화, 추상화 하여 체계적으로 표현한 개념적 모델
- 데이터,관계, 의미 및 일관성, 제약 조건등을 기술하기 위한 개념적 도구들의 모임
- 구조를 논리적으로 표현하기 위한 지능적 도구
#### 데이터 구성요소
- 객체, 속성, 관계
- 개념적, 논리적, 물리적
- 구조,연산, 제약 조건
## 2. 모델의 구성 요소
- 개체(Entity): 데이터베이스를 표현한 것, 정보나 단위 같은 대상체
- 속성(Attribute): 가장 작은 논리 단위, 파일 구조상의 데이터 항목 혹은 필드 해당
- 관계(Relationship): 개체간의 관계,혹은 속성간의 논리적 연결
## 3. 개념적 데이터 모델
- 추상적 개념으로 표현
- 서로 다른 개체 타입을 이용하여 현실 세계를 표현
- 인간이 이해할 수 있는 데이터로 표시(정보 모델)
- Ex) E-R 모델
## 4. 논리적 데이터 모델
- 개념으로 얻은 과정을 논리적 구조로 컴퓨터의 환경으로 변환하는 과정
- 데이터 타입간의 관계를 표현
- 기본 데이터 모델은 논리적 모델을 의미
- 특정 DBMS는 논리적 모델링 하나만 사용함
- Ex) 관계, 네트워크, 계층로 구분
## 5. 데이터 모델에 표시할 요소
- 구조(Structure): 논리적으로 표현된 개체 타입들 간의 관계로 구조 및 정적 성질 표현
- 연산(Operation): 작업에 대한 명세로 데이터베이스 조작하는 기본 도구
- 제약조건(Constraint): 데이터베이스에 저장할 수 있는 실제 데이터의 논리적인 제약 조건
# 3. E-R(개체 관계) 모델
## 1. 모델 개요 
- Peter Chem의 제안하였고 기본적인 구성 요소가 정립
- 개체간의 관계를 기본 요소로 개념적인 논리 데이터로 표현하기 위한 방법
- 개채간의 관계를 개념적으로 표현
- E-R 모델에서는 Entity, Attribute,Relationship으로 묘사
- 특정 DBMS를 고려한 것이 아님
- 일 대 일, 일 대 다, 다 대 다의 관계 유형을 제한 없이 표현
- 일반화 계층 같은 복잡한 개념들이 첨가되어 확장된 모델로 발전
## 2. E-R 다이어그램
- 사각형: 개체타입
- 마름모: 관계 타입
- 타원: 속성
- 이중 타원: 다중 속성
- 밑줄 타원: 기본 키 속성
- 복수 타원: 복합 속성
- 관계: 대응수를 선위에 표현
- 선,링크: 개체 타입과 속성을 연결
# 4. 관계형 데이터베이스의 구조
## 1. 개요
- Codd가 처음 제안
- 개체,관계 모두 릴레이션이라는 표로 표현
- 장점: 간결하고 보기 편함, 데이터베이스 변환 가능
- 단점: 성능 떨어짐
## 2. 관계형 데이터페이스 Relation 구조
- 테이블의 형태로 표현한 것으로 구조를 나타내는 릴레이션 스키마와 실제 값들을 인스턴스함
#### 구성요소
- 튜플(Tuple)
    - 각각의 행
    - 속성의 모임
    - 레코드와 같은 의미
    - 카디널리티 또는 기수, 대응수
- 속성(Attribute)
    - 가장 작은 논리 단위
    - 데이터 항목 or 데이터 필드
    - 개체의 특성 기술
    - 디그리 또는 차수
- 도메인(Domain)
    - 애트리뷰트가 취할 수 있는 원자값들의 집합
    - 실제 애트리뷰트 값이 나타날 때 그 값의 합법 여부를 시스템이 검사하는데 이용
## 3.릴레이션의 특징
- 똑같은 튜플이 포함 불가
- 튜플 사이의 순서가 없음
- 삽입, 삭제 작업으로 인해 시간이 변경
- 순서는 주요하지 않음
- 일일한 식별을 위해 속성의 명칭은 유일, 속성 구성값은 중복 허용
- 부분집합을 Key로 설정
- 논리적으로 원자값만 저장
# 5.관계형 데이터베이스의 제약 조건-Key
- 정확정을 보장하기 위해 키를 이용하여 입력되는 데이터에 제한을 주는 것으로 개체 무결성 제약, 참조 무결성 제약 등이 해당
## 1. Key의 개념 및 종류
- 조건에 만족하는 튜플을 찾거나 순서대로 정렬하는 기준 되는 애트리뷰트
## 2. 후보 키(Candidate Key)
- 유일하게 식별하기 위해 사용하는 속성들의 부분집합, 기본키로 사용할 수 있는 속성들을 말함
- 반드시 하나 이상의 후보키가 존재
- 유일성과 최소성을 만족시켜야 함
    - 유일성(Unique): 하나의 키로는 하나의 튜플만 식별
    - 최소성(Minimality): 식별하는 데 꼭 필요한 속성으로 구성
## 3. 기본키(Primary Key)
- 선정된 주키로 중복된 값을 가질 수 없음
- 튜플을 유일하게 구별할 수 있는 속성
- 후보키의 성질을 갖음, 유일성과 최소성을 가지며 튜플을 식별하기 위한 반드시 필요한 키
- Null 값을 가질 수 없다.
## 4. 대체키(Alternate Key)
- 후보키가 둘 이상일 때 기본키를 제외한 나머지 후보키를 의미
## 5. 슈퍼키(Super Key)
- 속성들의 집합으로 구성된 키로서 릴레이션을 구성하는 모든 슈퍼키로 구성된 속성의 집합과 동일한 값이 나타지 않음
## 6. 외래키(Foreign Key)
-  참조하는 속성 또는 속성들의 집합을 의미
- 릴레이션의 기본키와 대응되어 릴레이션 간에 참조 관계를 표현하는 중요한 도구
- 릴레이션의 기본키인 B가 동일한 정의되었을 때의 속성 A를 외래키
- 외래키로 지정되면 참조 릴레이션의 기본키에 없는 값은 입력할 수 없다
# 6. 관계형 데이터베이스의 제약 조건- 무결성
## 1. 무결성(Integrity)의 개념 및 종류
- 무결성이란 데이터베이스에 저장된 데이터 값과 현실의 일치하는 정확성을 의미
- 정확성을 보장하기 위해 부정확한 자료가 저장되는 것을 방지하기 위한 제약 조건
- 개체 무결성, 도메인, 무결성, 참조, 무결성, 사용자 정의 무결성
## 2. 개체 무결성(Entity Integrity, 실체 무결성)
- 기본키로 구성하는 어떤 속성도 Null 값이나 중복값을 가질수 없는 규정
## 3. 도메인 무결성(Domain Integrity, 영역 무결성)
- 무결성은 주어진 속성 값이 정의된 도메인에 속한 값이여야 함
## 4. 참조 무결성(Referential Integrity)
- 외래키 값은 Null이나 참조 릴레이션의 기본키 값과 동일해야 한다, 즉 릴레이션은 참조할 수 없는 외래키 값을 가질 수 없다는 규정
## 5. 사용자 정의 무결성(User-Defined Integrity)
- 정의 무결성은 속성 값들이 사용자가 정의한 제약조건에 만족해야 함
## 6. 데이터 무결성 강화
- 데이터 특성에 맞는 적절한 무결성을 정의하고 강화
- 데이터베이스 구척 과정에서 정의함
- 애플리케이션, 데이터베이스 트리거, 제약 조건을 이용하여 강화
#### 조건
##### 애플리케이션
- 데이터 생성, 수정, 삭제 시 무결성 조건을 검증하는 코드를 데이터를 조작하는 프로그램 내에 추가
- 코드를 이용한 복잡한 규칙 등을 검토하는 무결성 검사는 데이터베이스에서 수행하기 어려우므로 애플리케이션 내에서 처리
- 장점: 사용자 정의 같은 복잡한 무결성 조건의 구현 가능
- 단점: 소스 코드에 분산되어 있어 관리가 힘들고, 개별적인 시행으로 인해 적정성 검토가 어렵다
##### 데이터베이스 트리거
- 절차형 SQL 추가
- 장점: 통합 관리가 가능, 복잡한 요구 조건의 구현 가능
- 단점: 운영 중 변경이 어렵고, 사용상 주의가 필요
##### 제약 조건
- 데이터베이스에 제약 조건을 설정하여 무결성을 유지
- 장점: 통합 관리 가능, 간단한 선언으로 구현 가능, 변경 용이, 오류 데이터 발생 방지
- 단점: 복잡한 제약 조건의 구현과 예외적인 처리 불가능
# 7. 관계대수 및 관계해석
## 1.관계대수의 개요
- 관계대수는 릴레이션을 처리하기 위해 연산자와 연산규칙을 제공하는 언어로 피연산자가 릴레이션이고 결과도 릴레이션
- 질의에 대한 해를 구하기 위해 수행해야 할 연산의 순서를 명시
- 관계대수에는 관계 데이터베이스에 적용하기 위해 특별히 개발한 순수 관계 연산자와 수학적 집합 이론에서 사용하는 일반 집합 연산자
- 순수 관계: Select, Project, Join, Division
- 일반 집합: Union(교집합),Intersection(교집합),Difference(차집합),Cartesian Product(교차곱)
## 2.Select
- Select 릴레이션에 존재하는 튜플 중에서 선택 조건을 만족하는 튜플의 부분집합을 구하여 새로운 릴레이션을 만든는 연산
- 릴리이션의 행에 해당하는 튜플을 구하는 것으로 수행 연산
- 연산 기호는 시그마 사용
- R은 릴레이션 이름
- 여러 조건을 하나의 조건으로 결합시킬 수도 있음
## 3.Project
- 속성 리스트에 제시된 속성 값만을 추출하여 새로운 릴레이션을 만드는 연산, 중복이 발생하면 중복이 제거
- 열에 해당하는 Attribute 추출하는 것이므로 수직 연산자
- 연산자의 기호는 파이를 사용
## 4.Join
- 두 개의 릴레이션을 하나로 합쳐서 새로운 릴레이션을 만드는 연산
- Join의 결과로 만들어진 차수는 조인된 두 릴레이션의 차수를 합한 것
- Join의 결과는 교차곱을 수행하고 Select 수행한 것
- >< 사용
## 5.Division
- 두 개의 릴레이션 R와S 있을 때 모두 가진 튜플에서 S가 가진 속성을 제외한 속성만을 구현하는 연산
## 6. 일반 집합 연산자
- 연산자는 수학적 집합 이론에서 사용하는 연산자로서 릴레이션 연산자에도 그대로 적용
- 합집합,교집합,차집합을 처리하기 위해서 합병 조건을 만족
## 7.관계해석
- 코드가 수작의 술어 해석에 기반을 두고 관계 데이터베이스를 위해 제안
- 관계해석은 관계 데이터의 연산을 표현하는 방법
- 관계해석은 원하는 정보가 무엇이라는 것만 정의하는 비절차적 특성
- 튜플 관계해석과 도메인 관계해석
- 기본적으로 관계해석과 관계대수는 관계 데이터베이스를 처리하는 기능과 능력면에서 동등하며, 관계대수로 표현한 식은 관계해석으로 표현
# 8.정규화(Normalization)
## 1. 정규화의 개요
- 함수적 종속성 등의 종속 이론을 이용하여 잘못 설계된 관계형 스키마를 더 작은 속성의 세트로 나눠 스키마 작성
- 하나의 종속성이 릴레이션에 표현될 수 있도록 분해하는 과정
- 차수가 높아질수록 만족시켜야 할 제약조건이 늘어남
- 데이터베이스의 논리적 설계 단계에서 수행
- 논리적 처리 및 품질에 큰 영향을 미침
- 데이터 모델은 일관성, 정확성, 단순성, 비중복성, 안정성 등을 보장
- 정규화 수준이 높을수록 유연한 구현 가능, 정확도 증가 
- 물리적 조건(Join)이 많으면 조회 성능이 떨어짐
## 2. 정규화 목적
- 데이터 구조의 안정성및 무결성 유지
- 릴레이션이라도 데이터베이스 내에서 표션 가능
- 효과적인 검색 알고리즘을 생성
- 중복을 배제하여 이상의 발생 방지 및 자료 저장 공간의 최소화 가능 
- 데이터 삽입 시 릴레이션을 재구성할 필요성을 줄임
- 단순화 가능
- 속성의 배열 상태 검증 가능
- 개체와 속성 누락 여부 확인 가능
- 자료 검색과 추출의 효율성을 추구
## 3.이상의 개념 및 종류
- 릴레이션 조작시 예기치 못한 상황을 이상이라 정의함
#### 종류
- 삽입 이상(Insertion Anomaly)
    - 의도와 상관없이 불필요값 삽입
- 삭제 이상(Deletion Anomaly)
    - 릴레이션 삭제시 의도와 상관없이 함꼐 삭제
- 갱신 이상(Update Anomaly)
    - 튜플에 있는 속성값을 갱신할 때 일부 튜플의 정보만 갱신되어 정보에 모순이 생기는 현상
## 4. 정규화원칙
- 정보의 무손실 표현
    - 하나의 스키마를 다른 스키마로 변환할 때 정보의 손실이 없어야됨
- 분리의 원칙
    - 즉 하나의 독립된 관계성은 하나의 독립된 릴레이션으로 분리시켜 표현
- 데이터 중복 감소
## 5. 정규화
- 1. 1 정규형
    - 모든 도메인이 원자값으로만 되어있는 정규형
        - 릴레이션의 모든 속성이 단순 영역에서 정의
- 2. 2 정규형
    - R이 1NF임
        - 기본키가 아닌 모든 속성이 기본키에 의한 완전 함수적 종속을 만드는 규형
#### 함수적 종속 완전/부분 이해
- 함수적 종속
    - 데이터들이 어떤값에 의해 종속된 것
- 완전 함수적 종속
    - 어떤 속성이 기본키에 의해 완전히 종속되는 것
    - 완전한 종속 집합 A,B가 있으면 B는 A에 완전히 들어가 있으면 B는 A의 완전 종속
- 부분 종속
    - 기본키가 부분적으로 종속되어 있는 것
    - 교집합
----
- 3. 3정규형
    - R이 2NF
    - 기본키가 아닌 모든 속성이 기본키에 대해 이행적 종속을 만족하지 않는 정규형
    - 무손실 조인 또는 종속 보존을 저해하지 않고 항상 3NF를 할 수 있음
- BCNF
    - 릴레이션 R에서 모든 결정자가 모두 후보키인 정규형
    - 후보기카 여러개 존재하며 중첩되는 경우 강한 3정규형
    - 종속성을 보전하는 것
#### BCNF 제약조건
- 키가 아닌 모든 속성은 각 키에 대하여 완전 종속이여함
- 키가 아닌 모든 속성은 그 자신이 부분적으로 들어가 있지 않은 모든 키에 대하여 완전 종속
- 키가 아닌 속성에 대해서는 완전 종속할 수 없다

- 4. 4정규형
    - R에 다치 종속 A ->> B가 성립하는 경우 R의 모든 속성이 A 함수적 종속 관계를 만족하는 정규형
- 5. 5정규형
    - 릴레이션 R의 모든 조인 종속이 R의 후보키를 통해서만 성립되는 정규형
# 9. 반정규화(Denoramlization)
## 1. 반정규화 개요
- 의도적으로 정규화 원칙을 위배하는 행위
- 성능이 향상되고 관리 효율성은 증가하지만 데이터의 일관성, 정합성이 저하
- 과도한 반정규화는 성능을 낮춤
- 사전에 데이터의 일관성과 무결성을 우선으로 할지, 데이터베이스의 성능과 단순화를 우선으로 할지 결정
- 테이블 통합, 분할, 중복 추가, 종복 속성 추가
## 2. 테이블 통합
- Join많이 사용 성능 향상
- 두 개의 테이블에서 자주 처리될때 항상 조회하는 테이블을 통합
- 슈퍼타입/서브타임(슈퍼는 상위, 서브는 하위)
#### 통합 시 고려사항
- 검색은 간편하지만 레코드 증가로 처리량 증가
- 입력,수정,삭제 규칙이 복잡해짐
- Null, Default, Check 등 제약 조건설계 어려움
## 3. 테이블 분할
- 수직/수평으로 분할
- 수평 분할
    - 레코드를 기준으로 테이블을 분할하는 것
    - 레코드별로 사용 빈도의 차이가 큰 경우 사용 빈도에 따라 분할
- 수직 분할
    - 하나의 테이블에 속성이 많을때 진행
    - 갱신 위주의 속성 분할: 데이터 갱신 시 레코드 잠금으로 인해 다른 작업을 수행할 때 갱신 되는 것을 분할
    - 자주 조회되는 속성 분할: 자주 조회되는 속성을 분할
    - 크기가 큰 속성 분할: 이미지나, 텍스트 클 때 사용
    - 보안을 적용해야 하는 속성 분할: 특정 속성에 보안을 추가해야 할때 수행
#### 테이블 분할시 고려사항
- 기본키의 유일성 관리 어려움
- 데이터 양이 적거나 사용 빈도가 낮을 때 분할 필요 고려
- 수행 속도 감소
- 중점을 두어 분할 여부 결정
## 4. 중복 테이블 추가
- 추출해서 사용해야 하거나 다른 서버에 저장된 테이블을 이용해야 할 경우 추가하여 사용
- 중복 테이블을 추가 하는 경우
    - 정규화로 인해 수행 속도가 낮을 때
    - 많은 범위 데이터 처리할 때
    - 특정 범위 자주 사용할 때
    - 처리 범위를 줄이지 않고 속도 개선이 어려울 경우
- 집계 테이블 추가
    - 데이터를 위한 테이블 생성, 각 원본 테이블 트리거를 설정함, 오버해드 유의
- 진행 테이블의 추가
    - 이력 관리등 목적으로 추가, 양의 유지와 활용도를 높이기 위해 기본키로 적절
- 특정 부분만 포함하는 테이블 추가
    - 데이터가 많은 테이블의 특정 부분만을 사요하는 경우 해당 부분만으로 새로운 테이블 생성
## 5. 중복 속성 추가
- 데이터를 조회하는 경로를 단축하기 위해 자주 사용하는 속성을 하나 더 추가
- 무결성 확보가 어렵고 디스크 공간이 추가 필요
- 추가하는 경우
    - 조인이 자주 발생하는 속성
    - 접근 경로가 복잡한 속성
    - 액세스의 조건으로 자주 사용하는 속성
    - 기본키의 형태가 적절하지 않거나 여러 개의 속성으로 구성
#### 고려사항
- 테이블, 속성 중복을 고려
- 일관성 및 무결성에 유의
- SQL 그룹 함수를 이용하여 처리할 수 있어야함
- 저장 공간의 지나친 낭비 고려
# 10. 시스템 카탈로그
## 1.System Catalog 의미
- 카탈로그는 시스템 그 자체에 관련이 있는 다양한 객체에 관한 정보를 포함하는 데이터 베이스
    - 정의나 명세에 관한 정보를 유지 관리하는 시스템 테이블
    - 데이터 사전에 저장되기 때문에 좁은 의미로는 카탈로그 데이터 사전
## 2. 시스템 카탈로그 저장 정보
- 시스템 카탈로그에 저장된 정보를 메타 메타 데이터
#### 메타 데이터 유형
- 데이터베이스 객체 정보: 테이블, 인터뷰, 뷰, 구조 및 통계 정보
- 사용자 정보: 아이디. 패스워드. 접근 권한
- 테이블의 무결성 제약 조건 정보: 기본,외래키,Null 허용 여부 등
- 함수, 프로시저, 트리거
## 3. 카탈로그의 특징
- SQL을 이용하여 내용을 검색해 볼 수 있음
- Insert, Delete, Update 카탈로그 갱신하는 것을 허용되지 않음
- 데이터베이스 시스템에 따라 상이한 구조
- 카탈로그는 DMS가 스스로 생성하고 유지
- 카탈로그의 갱신: 사용자 SQL 실행시켜 변화를 주면 시스템이 자동으로 갱신
- 분산 시스템에서의 카탈로그: 릴레이션, 인덱스, 사용자 등의 정보를 포함할 뿐 아니라 위치 투명성 및 중복 투명성을 제공
## 4. 카탈로그/데이터 사전을 참조하기 위한 DBMS 내의 모듈 시스템
- 데이터 정의어
    - DDL을 메타 데이터를 갖는 테이블로 변환하여 데이터 사전에 저장
- 데이터 조작어
    - 응용 프로그램에 삽입된 DML문 주 언어로 표현한 프로시저 호출로 변환하여 질의 처리기와 상호 통신
- Data Directory
    - 데이터 사전에 수록된 데이터를 실제로 접근하는 데 필요한 정보를 관리 유지하는 시스템
    - 시스템 카탈로그는 사용자와 시스템 모두 접근할 수 있지만 데이터 디렉터리는 시스템만 접근할 수 있음
- 질의 최적화기
    - 사용자의 요구를 효율적인 형태로 변환하고 질의를 처리하는 좋은 전략을 모색
- 트랜잭션 처리기
    - 복수 사용자 환경에서 평행으로 동시에 일어나는 트랜잭션 문제를 해결
    - 배타적으로 이용함
